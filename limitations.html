<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Contribution Guide" href="modules/contribution_guide.html" /><link rel="prev" title="Debugging" href="debugging.html" />

    <!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>Limitations - Warp 1.4.1</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=a91381f3" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-title-font-size: 100%;
  --admonition-font-size: 100%;
  --color-api-pre-name: #4e9a06;
  --color-api-name: #4e9a06;
  --color-admonition-title--seealso: #ffffff;
  --color-admonition-title-background--seealso: #448aff;
  --color-admonition-title-background--note: #76b900;
  --color-admonition-title--note: #ffffff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #76b900;
  --color-admonition-title--note: #ffffff;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-admonition-title-background--note: #76b900;
  --color-admonition-title--note: #ffffff;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Warp 1.4.1</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo-light-mode.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo-dark-mode.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Warp 1.4.1</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/devices.html">Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/differentiability.html">Differentiability</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/generics.html">Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="codegen.html">Code Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/allocators.html">Allocators</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/concurrency.html">Concurrency</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiling.html">Profiling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/runtime.html">Runtime Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/functions.html">Kernel Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulation Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/sim.html">warp.sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/sparse.html">warp.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/fem.html">warp.fem</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/render.html">warp.render</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/warp">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/warp-lang">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.com/channels/827959428476174346/1285719658325999686">Discord</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/limitations.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/NVIDIA/warp/edit/main/docs/limitations.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="limitations">
<h1>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h1>
<p>This section summarizes various limitations and currently unsupported features in Warp.
Problems, questions, and feature requests can be opened on <a class="reference external" href="https://github.com/NVIDIA/warp/issues">GitHub Issues</a>.</p>
<section id="unsupported-features">
<h2>Unsupported Features<a class="headerlink" href="#unsupported-features" title="Link to this heading">¶</a></h2>
<p>To achieve good performance on GPUs some dynamic language features are not supported:</p>
<ul class="simple">
<li><p>Lambda functions</p></li>
<li><p>List comprehensions</p></li>
<li><p>Exceptions</p></li>
<li><p>Recursion</p></li>
<li><p>Runtime evaluation of expressions, e.g.: eval()</p></li>
<li><p>Dynamic structures such as lists, sets, dictionaries, etc.</p></li>
</ul>
</section>
<section id="kernels-and-user-functions">
<h2>Kernels and User Functions<a class="headerlink" href="#kernels-and-user-functions" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Strings cannot be passed into kernels.</p></li>
<li><p>Short-circuit evaluation is not supported</p></li>
<li><p><a class="reference internal" href="modules/functions.html#warp.atomic_add" title="warp.atomic_add"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.atomic_add()</span></code></a> does not support <code class="docutils literal notranslate"><span class="pre">wp.int64</span></code>.</p></li>
<li><p><a class="reference internal" href="modules/functions.html#warp.tid" title="warp.tid"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.tid()</span></code></a> cannot be called from user functions.</p></li>
<li><p>Modifying the value of a <code class="xref py py-class docutils literal notranslate"><span class="pre">wp.constant()</span></code> during runtime will not trigger
recompilation of the affected kernels if the modules have already been loaded
(e.g. through a <a class="reference internal" href="modules/runtime.html#warp.launch" title="warp.launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.launch()</span></code></a> or a <code class="docutils literal notranslate"><span class="pre">wp.load_module()</span></code>).</p></li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">wp.constant()</span></code> can suffer precision loss if used with <code class="docutils literal notranslate"><span class="pre">wp.float64</span></code>
as it is initially assigned to a <code class="docutils literal notranslate"><span class="pre">wp.float32</span></code> variable in the generated code.</p></li>
</ul>
<p>A limitation of Warp is that each dimension of the grid used to launch a kernel must be representable as a 32-bit
signed integer. Therefore, no single dimension of a grid should exceed <span class="math notranslate nohighlight">\(2^{31}-1\)</span>.</p>
<p>Warp also currently uses a fixed block size of 256 (CUDA) threads per block.
By default, Warp will try to process one element from the Warp grid in one CUDA thread.
This is not always possible for kernels launched with multi-dimensional grid bounds, as there are
<a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#features-and-technical-specifications-technical-specifications-per-compute-capability">hardware limitations</a>
on CUDA block dimensions.</p>
<p>Warp will automatically fall back to using
<a class="reference external" href="https://developer.nvidia.com/blog/cuda-pro-tip-write-flexible-kernels-grid-stride-loops/">grid-stride loops</a> when
it is not possible for a CUDA thread to process only one element from the Warp grid.
When this happens, some CUDA threads may process more than one element from the Warp grid.
Users can also set the <code class="docutils literal notranslate"><span class="pre">max_blocks</span></code> parameter to fine-tune the grid-striding behavior of kernels, even for kernels that are otherwise
able to process one Warp-grid element per CUDA thread.</p>
</section>
<section id="differentiability">
<h2>Differentiability<a class="headerlink" href="#differentiability" title="Link to this heading">¶</a></h2>
<p>Please see the <a class="reference internal" href="modules/differentiability.html#limitations-and-workarounds"><span class="std std-ref">Limitations and Workarounds</span></a> section in the Differentiability page for auto-differentiation limitations.</p>
</section>
<section id="arrays">
<h2>Arrays<a class="headerlink" href="#arrays" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Arrays can have a maximum of four dimensions.</p></li>
<li><p>Each dimension of a Warp array cannot be greater than the maximum value representable by a 32-bit signed integer,
<span class="math notranslate nohighlight">\(2^{31}-1\)</span>.</p></li>
<li><p>There are currently no data types that support complex numbers.</p></li>
</ul>
</section>
<section id="structs">
<h2>Structs<a class="headerlink" href="#structs" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Structs cannot have generic members, i.e. of type <code class="docutils literal notranslate"><span class="pre">typing.Any</span></code>.</p></li>
</ul>
</section>
<section id="volumes">
<h2>Volumes<a class="headerlink" href="#volumes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>The sparse-volume <em>topology</em> cannot be changed after the tiles for the <a class="reference internal" href="modules/runtime.html#warp.Volume" title="warp.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> have been allocated.</p></li>
</ul>
</section>
<section id="multiple-processes">
<h2>Multiple Processes<a class="headerlink" href="#multiple-processes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>A CUDA context created in the parent process cannot be used in a <em>forked</em> child process.
Use the spawn start method instead, or avoid creating CUDA contexts in the parent process.</p></li>
<li><p>There can be issues with using same user kernel cache directory when running with multiple processes.
A workaround is to use a separate cache directory for every process.
See the <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Configuration</span></a> section for how the cache directory may be changed.</p></li>
</ul>
</section>
<section id="scalar-math-functions">
<h2>Scalar Math Functions<a class="headerlink" href="#scalar-math-functions" title="Link to this heading">¶</a></h2>
<p>This section details some limitations and differences from CPython semantics for scalar math functions.</p>
<section id="modulus-operator">
<h3>Modulus Operator<a class="headerlink" href="#modulus-operator" title="Link to this heading">¶</a></h3>
<p>Deviation from Python behavior can occur when the modulus operator (<code class="docutils literal notranslate"><span class="pre">%</span></code>) is used with a negative dividend or divisor
(also see <a class="reference internal" href="modules/functions.html#warp.mod" title="warp.mod"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.mod()</span></code></a>).
The behavior of the modulus operator in a Warp kernel follows that of C++11: The sign of the result follows the sign of
<em>dividend</em>. In Python, the sign of the result follows the sign of the <em>divisor</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span> <span class="nf">modulus_test</span><span class="p">():</span>
    <span class="c1"># Kernel-scope behavior:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1"># a is -1</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">%</span> <span class="o">-</span><span class="mi">2</span> <span class="c1"># b is 1</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">%</span> <span class="mi">0</span>  <span class="c1"># Undefined behavior</span>

<span class="c1"># Python-scope behavior:</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1"># a is 1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">%</span> <span class="o">-</span><span class="mi">2</span> <span class="c1"># b is -1</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">%</span> <span class="mi">0</span>  <span class="c1"># ZeroDivisionError</span>
</pre></div>
</div>
</section>
<section id="power-operator">
<h3>Power Operator<a class="headerlink" href="#power-operator" title="Link to this heading">¶</a></h3>
<p>The power operator (<code class="docutils literal notranslate"><span class="pre">**</span></code>) in Warp kernels only works on floating-point numbers (also see <a class="reference internal" href="modules/functions.html#warp.pow" title="warp.pow"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.pow()</span></code></a>).
In Python, the power operator can also be used on integers.</p>
</section>
<section id="inverse-sine-and-cosine">
<h3>Inverse Sine and Cosine<a class="headerlink" href="#inverse-sine-and-cosine" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="modules/functions.html#warp.asin" title="warp.asin"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.asin()</span></code></a> and <a class="reference internal" href="modules/functions.html#warp.acos" title="warp.acos"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.acos()</span></code></a> automatically clamp the input to fall in the range [-1, 1].
In Python, using <a class="reference external" href="https://docs.python.org/3/library/math.html#math.asin" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.asin()</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/math.html#math.acos" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.acos()</span></code></a>
with an input outside [-1, 1] raises a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception.</p>
</section>
<section id="rounding">
<h3>Rounding<a class="headerlink" href="#rounding" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="modules/functions.html#warp.round" title="warp.round"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.round()</span></code></a> rounds halfway cases away from zero, but Python’s
<a class="reference external" href="https://docs.python.org/3/library/functions.html#round" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">round()</span></code></a> rounds halfway cases to the nearest even
choice (Banker’s rounding). Use <a class="reference internal" href="modules/functions.html#warp.rint" title="warp.rint"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.rint()</span></code></a> when Banker’s rounding is
desired. Unlike Python, the return type in Warp of both of these rounding
functions is the same type as the input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span> <span class="nf">halfway_rounding_test</span><span class="p">():</span>
    <span class="c1"># Kernel-scope behavior:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># a is 1.0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># b is 0.0</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span> <span class="c1"># c is 2.0</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>  <span class="c1"># d is 2.0</span>

<span class="c1"># Python-scope behavior:</span>
<span class="n">a</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># a is 0</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span> <span class="c1"># c is 2</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="modules/contribution_guide.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contribution Guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="debugging.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Debugging</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2024, NVIDIA Corporation
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/NVIDIA/warp" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Limitations</a><ul>
<li><a class="reference internal" href="#unsupported-features">Unsupported Features</a></li>
<li><a class="reference internal" href="#kernels-and-user-functions">Kernels and User Functions</a></li>
<li><a class="reference internal" href="#differentiability">Differentiability</a></li>
<li><a class="reference internal" href="#arrays">Arrays</a></li>
<li><a class="reference internal" href="#structs">Structs</a></li>
<li><a class="reference internal" href="#volumes">Volumes</a></li>
<li><a class="reference internal" href="#multiple-processes">Multiple Processes</a></li>
<li><a class="reference internal" href="#scalar-math-functions">Scalar Math Functions</a><ul>
<li><a class="reference internal" href="#modulus-operator">Modulus Operator</a></li>
<li><a class="reference internal" href="#power-operator">Power Operator</a></li>
<li><a class="reference internal" href="#inverse-sine-and-cosine">Inverse Sine and Cosine</a></li>
<li><a class="reference internal" href="#rounding">Rounding</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=350a9c04"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=fd10adb8"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>